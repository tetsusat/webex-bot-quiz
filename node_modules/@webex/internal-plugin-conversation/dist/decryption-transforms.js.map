{"version":3,"sources":["decryption-transforms.js"],"names":["decryptTextProp","name","ctx","key","object","transform","transforms","decryptObject","undefined","resolve","objectType","encryptionKeyUrl","all","files","items","map","item","decryptSubmit","inputs","decryptionFailureMessage","webex","internal","conversation","config","then","JSON","parse","catch","reason","logger","warn","decryptReaction2summary","reactions","reaction","decryptReaction2selfsummary","decryptReaction2","decryptConversation","promises","activities","push","usableKey","error","url","avatarEncryptionKeyUrl","avatar","previous","previousValue","decryptActivity","activity","keyUrl","children","child","decryptMicroappinstance","microappInstance","decryptComment","comment","cards","index","decryptContent","content","contentCategory","decryptContentFiles","links","forEach","decryptContentLinks","decryptEvent","event","location","split","length","decryptFile","file","transcodedCollection","image","decryptLink","link","decryptTranscodedContent","transcodedContent","decryptImageURI","imageURI","encryption","decryptText","plaintext","keepEncryptedProperties","encryptedPropName","decryptPropCardItem","array","String","decryptPropScr","decryptScr","scr","decryptPropSslr","sslr","decryptPropDisplayName","decryptPropContent","decryptPropModel","decryptPropLocation"],"mappings":"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","sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {camelCase, capitalize, curry} from 'lodash';\n\nimport toArray from './to-array';\n\nconst decryptTextProp = curry((name, ctx, key, object) => ctx.transform('decryptTextProp', name, key, object));\n\n// eslint-disable-next-line import/prefer-default-export\nexport const transforms = toArray('inbound', {\n\n  /**\n   * This function is used recursively to decrypt various properties on convesations, activities, etc\n   * @param   {Object} ctx    An object containg a webex instance and a transform\n   * @param   {String} key    KMS encryption key url\n   * @param   {Object} object Generic object that you want to decrypt some property on based on the type\n   * @returns {Promise}       Returns a transform promise\n   */\n  decryptObject(ctx, key, object) {\n    if (!object) {\n      object = key; // eslint-disable-line no-param-reassign\n      key = undefined; // eslint-disable-line no-param-reassign\n    }\n\n    if (!object) {\n      return Promise.resolve();\n    }\n\n    if (!object.objectType) {\n      return Promise.resolve();\n    }\n\n    if (!key && object.encryptionKeyUrl) {\n      key = object.encryptionKeyUrl; // eslint-disable-line no-param-reassign\n    }\n\n    // Transcoded content was not showing up on the activities since the\n    // decryptFile was not being called. Calling decryptFile for\n    // transcodedContent fixes the issue.\n    if (object.objectType === 'transcodedContent') {\n      return Promise.all(object.files.items.map((item) => ctx.transform('decryptFile', key, item)));\n    }\n\n    return ctx.transform(`decrypt${capitalize(object.objectType)}`, key, object);\n  },\n\n  /**\n   * Decrypt an individual submit object from a cardAction activity\n   *   (object.objectType === 'sumbit')\n   * @param   {Object} ctx      An object containg a webex instance and a transform\n   * @param   {String} key      KMS key\n   * @param   {Object} object An instance of a Webex Teams submit object\n   * these objects are returned when a user clicks on a Action.Submit button in a card\n   * @returns {Promise}         Returns a ctx.transform promise\n   */\n  decryptSubmit(ctx, key, object) {\n    if (!object.inputs) {\n      return Promise.resolve();\n    }\n    const {decryptionFailureMessage} = ctx.webex.internal.conversation.config;\n\n    return ctx.transform('decryptPropCardItem', 0, key, [object.inputs])\n      .then((inputs) => {\n        object.inputs = JSON.parse(inputs[0]); // eslint-disable-line no-param-reassign\n      })\n      .catch((reason) => {\n        ctx.webex.logger.warn(`plugin-conversation: failed to decrypt attachmentAction.inputs: ${reason}`);\n        object.inputs = decryptionFailureMessage; // eslint-disable-line no-param-reassign\n\n        return Promise.resolve(decryptionFailureMessage);\n      });\n  },\n\n  /**\n   * Decrypt an individual reaction2Summary activity (object.objectType === 'reaction2Summary')\n   * @param   {Object} ctx      An object containg a webex instance and a transform\n   * @param   {String} key      KMS key\n   * @param   {Object} object An instance of a Webex Teams reaction2Summary object\n   * these objects are returned by various conversation APIs and over mercury\n   * represents an aggregated summary of all reactions to a specific activity\n   * @returns {Promise}         Returns a ctx.transform promise\n   */\n  decryptReaction2summary(ctx, key, object) {\n    if (!object.reactions) {\n      return Promise.resolve();\n    }\n\n    return Promise.all(object.reactions.map((reaction) => ctx.transform('decryptPropDisplayName', key, reaction)));\n  },\n\n  /**\n   * Decrypt an individual reaction2SelfSummary activity (object.objectType === 'reaction2SelfSummary')\n   * @param   {Object} ctx      An object containg a webex instance and a transform\n   * @param   {String} key      KMS key\n   * @param   {Object} object An instance of a Webex Teams reaction2SelfSummary object\n   * these objects are returned by various conversation APIs and NOT over mercury\n   * they are ONLY received by the self user\n   * they represent ONLY the self user's reactions and are used for enforcing\n   * limit of times they can react to a specific activity\n   * @returns {Promise}         Returns a ctx.transform promise\n   */\n  decryptReaction2selfsummary(ctx, key, object) {\n    if (!object.reactions) {\n      return Promise.resolve();\n    }\n\n    return Promise.all(object.reactions.map((reaction) => ctx.transform('decryptPropDisplayName', key, reaction)));\n  },\n\n  /**\n   * Decrypt an individual reaction2 activity (object.objectType === 'reaction2')\n   * @param   {Object} ctx      An object containg a webex instance and a transform\n   * @param   {String} key      KMS key\n   * @param   {Object} object An instance of a Webex Teams reaction2 object\n   * these objects are returned by various conversation APIs and over mercury\n   * ONLY self users receive these objects\n   * @returns {Promise}         Returns a ctx.transform promise\n   */\n  decryptReaction2(ctx, key, object) {\n    return ctx.transform('decryptPropDisplayName', key, object);\n  },\n\n  /**\n   * Decrypts a given conversation and it's activites by building an array of promises that call\n   * decryptObject, which may then call other decrypt functions\n   *\n   * @param   {Object} ctx          An object containg a webex instance and a transform\n   * @param   {String} key          KMS encryption key url (or actual key?)\n   * @param   {Object} conversation A Webex Teams conversation object\n   * @returns {Promise}             Returns the result of Promise.all\n   */\n  decryptConversation(ctx, key, conversation) {\n    const promises = [];\n\n    if (conversation.activities.items) {\n      promises.push(Promise.all(conversation.activities.items.map((item) => ctx.transform('decryptObject', null, item))));\n    }\n\n    const usableKey = conversation.encryptionKeyUrl || key;\n    const {decryptionFailureMessage} = ctx.webex.internal.conversation.config;\n\n    if (usableKey) {\n      promises.push(ctx.transform('decryptPropDisplayName', usableKey, conversation)\n        .catch((error) => {\n          ctx.webex.logger.warn('plugin-conversation: failed to decrypt display name of ', conversation.url, error);\n          Promise.resolve(decryptionFailureMessage);\n        }));\n      promises.push(ctx.transform('decryptPropContent', usableKey, conversation));\n    }\n    if (conversation.avatarEncryptionKeyUrl) {\n      promises.push(ctx.transform('decryptObject', conversation.avatarEncryptionKeyUrl, conversation.avatar));\n    }\n    // TODO (holsted 04/06/19): This was deprecated in favor of .previousValue below. I wanted to remove this entirely\n    // but I wasn't sure if some open source use cases may be reading from cached conversations or not so leaving it for now.\n    if (conversation.previous) {\n      promises.push(ctx.transform('decryptPropDisplayName', usableKey, conversation.previous));\n    }\n    if (conversation.previousValue) {\n      promises.push(ctx.transform('decryptPropDisplayName', usableKey, conversation.previousValue));\n    }\n\n    return Promise.all(promises);\n  },\n\n  /**\n   * Decrypt an individual activity\n   * @param   {Object} ctx      An object containg a webex instance and a transform\n   * @param   {String} key      KMS encryption key url (or actual key?)\n   * @param   {Object} activity An instance of a Webex Teams activity\n   * @returns {Promise}         Returns a ctx.transform promise\n   */\n  decryptActivity(ctx, key, activity) {\n    if (!activity.encryptionKeyUrl && !(activity.object && activity.object.encryptionKeyUrl)) {\n      return Promise.resolve(activity);\n    }\n\n    const keyUrl = activity.encryptionKeyUrl || activity.object.encryptionKeyUrl || key;\n\n    let promises = [];\n\n    // iterate and recursively decrypt over children objects\n    if (activity.children && Array.isArray(activity.children)) {\n      promises = activity.children.map((child) => ctx.transform('decryptObject', keyUrl, child.activity));\n    }\n\n    promises.push(ctx.transform('decryptObject', keyUrl, activity.object));\n\n    return Promise.all(promises);\n  },\n\n  /**\n   * Decrypts a microappInstance (recording) model\n   * @param   {Object} ctx                     An object containing a webex instance and transform prop\n   * @param   {String} key                     KMS key\n   * @param   {Object} microappInstance        A microappInstance which includes several properties of a recording\n   * @param   {String} microappInstance.model  An encrypted string which decrypts to an object\n   * @returns {Promise}                        Returns a contex transform\n   */\n  decryptMicroappinstance(ctx, key, microappInstance) {\n    return ctx.transform('decryptPropModel', key, microappInstance);\n  },\n\n  /**\n* Decrypts a comment...\n* @param {Object} ctx An object containing a webex instance and transform prop\n* @param {String} key KMS key\n* @param {Object} comment A comment object with a displayName and content (encrypted)\n* @returns {Promise} Returns the results of Promise.all on two transforms\n*/\n  decryptComment(ctx, key, comment) {\n    const promises = [\n      ctx.transform('decryptPropDisplayName', key, comment),\n      ctx.transform('decryptPropContent', key, comment)\n    ];\n\n    if (comment.cards && Array.isArray(comment.cards)) {\n      comment.cards.map((item, index) => promises.push(ctx.transform('decryptPropCardItem', index, key, comment.cards)));\n    }\n\n    return Promise.all(promises);\n  },\n\n  /**\n   * Decrypts a content field\n   * @param   {Object} ctx            An object containing a webex instance and transform prop\n   * @param   {String} key            KMS key\n   * @param   {Object} content        An object with properties to be decrypted\n   * @returns {Promise}               A promise that will return when the decryption has finished\n   */\n  decryptContent(ctx, key, content) {\n    if (content.contentCategory === 'links') {\n      return ctx.transform('decryptContentLinks', key, content);\n    }\n\n    return ctx.transform('decryptContentFiles', key, content);\n  },\n\n  /**\n   * Decrypts a content field which contains files and possibly links\n   * @param   {Object} ctx            An object containing a webex instance and transform prop\n   * @param   {String} key            KMS key\n   * @param   {Object} content        An object with properties to be decrypted\n   * @param   {Array}  content.files  An array of files to decrypt by calling decryptObject\n   * @param   {Array}  content.links  An array of links to decrypt by calling decryptObject\n   * @returns {Promise}               A promise that will return when the decryption has finished\n   */\n  decryptContentFiles(ctx, key, content) {\n    if (!content.files || !content.files.items || !Array.isArray(content.files.items)) {\n      return Promise.resolve();\n    }\n\n    const promises = content.files.items.map((item) => ctx.transform('decryptObject', key, item));\n\n    promises.push(ctx.transform('decryptComment', key, content));\n\n    if (content.links && content.links.items && Array.isArray(content.links.items)) {\n      content.links.items.forEach((item) => promises.push(ctx.transform('decryptObject', key, item)));\n    }\n\n    return Promise.all(promises);\n  },\n\n  /**\n   * Decrypts a content field which contains links\n   * @param   {Object} ctx            An object containing a webex instance and transform prop\n   * @param   {String} key            KMS key\n   * @param   {Object} content        An object with properties to be decrypted\n   * @param   {Array}  content.links  An array of links to decrypt by calling decryptObject\n   * @returns {Promise}               A promise that will return when the decryption has finished\n   */\n  decryptContentLinks(ctx, key, content) {\n    if (!content.links || !content.links.items || !Array.isArray(content.links.items)) {\n      return Promise.resolve();\n    }\n\n    const promises = content.links.items.map((item) => ctx.transform('decryptObject', key, item));\n\n    promises.push(ctx.transform('decryptComment', key, content));\n\n    return Promise.all(promises);\n  },\n\n  /**\n   * Decrypts what may be a meeting event?\n   * @param   {Object} ctx   An object containing a webex instance and transform prop\n   * @param   {String} key   KMS key\n   * @param   {Object} event An object with a display name and location to be decrypted\n   * @returns {Promise}      Returns the result of Promise.all\n   */\n  decryptEvent(ctx, key, event) {\n    const promises = [\n      ctx.transform('decryptPropDisplayName', key, event)\n    ];\n\n    if (event.location && event.location.split('.').length === 5) {\n      promises.push(ctx.transform('decryptPropLocation', key, event));\n    }\n\n    return Promise.all(promises);\n  },\n\n  /**\n   * Decrypts a file and it's transcodedContents if they exist\n   * @param   {Object} ctx  An object containing a webex instance and transform prop\n   * @param   {String} key  KMS key\n   * @param   {Object} file A file object with file props an optional transcodedCollection to decrypt\n   * @returns {Promise}     Returns the result of Promise.all\n   */\n  decryptFile(ctx, key, file) {\n    return Promise.all([\n      file.transcodedCollection && Promise.all(file.transcodedCollection.items.map((item) => ctx.transform('decryptObject', key, item))),\n      ctx.transform('decryptPropScr', key, file),\n      ctx.transform('decryptPropDisplayName', key, file),\n      ctx.transform('decryptPropContent', key, file),\n      file.image && ctx.transform('decryptPropScr', key, file.image)\n    ]);\n  },\n\n  /**\n   * Decrypts a file and it's transcodedContents if they exist\n   * @param   {Object} ctx  An object containing a webex instance and transform prop\n   * @param   {String} key  KMS key\n   * @param   {Object} link A link object with a URL to decrypt\n   * @returns {Promise}     Returns the result of Promise.all\n   */\n  decryptLink(ctx, key, link) {\n    return Promise.all([\n      ctx.transform('decryptPropSslr', key, link),\n      ctx.transform('decryptPropDisplayName', key, link)\n    ]);\n  },\n\n  /**\n   * Decrypts transcoded file content. Calls decryptFile\n   * @param   {Object} ctx               An object containing a webex instance and transform prop\n   * @param   {String} key               KMS key\n   * @param   {Object} transcodedContent Transcoded content with a files prop\n   * @returns {Promise}                  Returns the result of Promise.all\n   */\n  decryptTranscodedContent(ctx, key, transcodedContent) {\n    return Promise.all(transcodedContent.files.items.map((item) => ctx.transform('decryptFile', key, item)));\n  },\n\n  /**\n   * Decrypts an image uri\n   * @param   {Object} ctx       An object containing a webex instance and transform prop\n   * @param   {String} key       KMS key\n   * @param   {String} imageURI  URI of the image to decrypt\n   * @returns {Promise}          Returns a promise.\n   */\n  decryptImageURI(ctx, key, imageURI) {\n    return ctx.transform('decryptPropLocation', key, imageURI);\n  },\n\n  /**\n   * The heart of most decryption logic ends here. Decrypting text.\n   * @param   {Object} ctx    An object containing a webex instance and transform prop\n   * @param   {String} name   Property of an object to be decrypted\n   * @param   {String} key    KMS key\n   * @param   {Object} object A generic object with text props to be decrypted\n   * @returns {Promise}       Returns a lonely Promise\n   */\n  decryptTextProp(ctx, name, key, object) {\n    if (!object[name]) {\n      return Promise.resolve();\n    }\n    const {decryptionFailureMessage} = ctx.webex.internal.conversation.config;\n\n    return ctx.webex.internal.encryption.decryptText(key, object[name])\n      .then((plaintext) => {\n        if (ctx.webex.config.conversation.keepEncryptedProperties) {\n          const encryptedPropName = camelCase(`encrypted_${name}`);\n\n          object[encryptedPropName] = object[name]; // eslint-disable-line no-param-reassign\n        }\n\n        object[name] = plaintext; // eslint-disable-line no-param-reassign\n      })\n      .catch((reason) => {\n        ctx.webex.logger.warn(`plugin-conversation: failed to decrypt ${name} `, reason);\n        object[name] = decryptionFailureMessage; // eslint-disable-line no-param-reassign\n\n        return Promise.resolve(decryptionFailureMessage);\n      });\n  },\n\n  /**\n* Decrypting an element in an Array.\n* @param {Object} ctx An object containing a webex instance and transform prop\n* @param {Integer} index Property of an object to be decrypted\n* @param {String} key KMS key\n* @param {Array} array An array of Strings to be decrypted\n* @returns {Promise} Returns a lonely Promise\n*/\n  decryptPropCardItem(ctx, index, key, array) {\n    if (!Number.isInteger(index) || !array || !Array.isArray(array) || index < 0 || index >= array.length || !(array[index] instanceof String || typeof array[index] === 'string')) {\n      return Promise.resolve();\n    }\n    const {decryptionFailureMessage} = ctx.webex.internal.conversation.config;\n\n    return ctx.webex.internal.encryption.decryptText(key, array[index])\n      .then((plaintext) => {\n        array[index] = plaintext; // eslint-disable-line no-param-reassign\n      })\n      .catch((reason) => {\n        ctx.webex.logger.warn(`plugin-conversation: failed to decrypt card at ${index} `, reason);\n        array[index] = decryptionFailureMessage; // eslint-disable-line no-param-reassign\n\n        return Promise.resolve(decryptionFailureMessage);\n      });\n  },\n  /**\n   * Decrypts the src of an object (for images?)\n   * @param   {Object} ctx    An object containing a webex instance and transform prop\n   * @param   {String} key    KMS key\n   * @param   {Object} object An object with a scr property to be decrypted\n   * @returns {Promise}       Returns a promise\n   */\n  decryptPropScr(ctx, key, object) {\n    return ctx.webex.internal.encryption.decryptScr(key, object.scr)\n      .then((scr) => {\n        object.scr = scr; // eslint-disable-line no-param-reassign\n      });\n  },\n\n  /**\n   * Decrypts the sslr object\n   * @param   {Object} ctx    An object containing a webex instance and transform prop\n   * @param   {String} key    KMS key\n   * @param   {Object} object An object with a sslr property to be decrypted\n   * @returns {Promise}       Returns a promise\n   */\n  decryptPropSslr(ctx, key, object) {\n    return ctx.webex.internal.encryption.decryptScr(key, object.sslr)\n      .then((sslr) => {\n        object.sslr = sslr; // eslint-disable-line no-param-reassign\n      });\n  },\n\n  decryptPropDisplayName: decryptTextProp('displayName'),\n\n  decryptPropContent: decryptTextProp('content'),\n\n  decryptPropModel: decryptTextProp('model'),\n\n  decryptPropLocation: decryptTextProp('location')\n});\n"]}